/data/miniconda3/lib/python3.8/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
==> Preparing data
    # train data:  28000
    # labeled train data:  28496
    # test data:  864
    # val x data: 13000
    # val p data: 13000
Processing...
Done!
Processing...
Done!
Number of training graphs: 57
Number of test graphs: 73
Processing...
Done!
Processing...
Done!
Number of training graphs: 57
Number of test graphs: 73
Confusion Matrix:
[[16 25]
 [ 2 30]]
Epoch: 000, Train Acc: 0.5088, Train Loss: 0.6928, Test Acc: 0.6301, Test Loss: 0.6748
Confusion Matrix:
[[11 30]
 [ 0 32]]
Epoch: 001, Train Acc: 0.8421, Train Loss: 0.6542, Test Acc: 0.5890, Test Loss: 0.6677
Confusion Matrix:
[[ 9 32]
 [ 0 32]]
Epoch: 002, Train Acc: 0.7193, Train Loss: 0.6233, Test Acc: 0.5616, Test Loss: 0.6642
Confusion Matrix:
[[ 6 35]
 [ 0 32]]
Epoch: 003, Train Acc: 0.7368, Train Loss: 0.5983, Test Acc: 0.5205, Test Loss: 0.6646
Confusion Matrix:
[[ 7 34]
 [ 0 32]]
Epoch: 004, Train Acc: 0.7193, Train Loss: 0.5760, Test Acc: 0.5342, Test Loss: 0.6659
Confusion Matrix:
[[ 9 32]
 [ 0 32]]
Epoch: 005, Train Acc: 0.7193, Train Loss: 0.5536, Test Acc: 0.5616, Test Loss: 0.6656
Confusion Matrix:
[[10 31]
 [ 0 32]]
Epoch: 006, Train Acc: 0.7368, Train Loss: 0.5323, Test Acc: 0.5753, Test Loss: 0.6597
Confusion Matrix:
[[11 30]
 [ 1 31]]
Epoch: 007, Train Acc: 0.7368, Train Loss: 0.5097, Test Acc: 0.5753, Test Loss: 0.6457
Confusion Matrix:
[[13 28]
 [ 1 31]]
Epoch: 008, Train Acc: 0.7544, Train Loss: 0.4849, Test Acc: 0.6027, Test Loss: 0.6243
Confusion Matrix:
[[15 26]
 [ 2 30]]
Epoch: 009, Train Acc: 0.7895, Train Loss: 0.4593, Test Acc: 0.6164, Test Loss: 0.5990
Confusion Matrix:
[[20 21]
 [ 2 30]]
Epoch: 010, Train Acc: 0.8246, Train Loss: 0.4362, Test Acc: 0.6849, Test Loss: 0.5746
Confusion Matrix:
[[23 18]
 [ 2 30]]
Epoch: 011, Train Acc: 0.8596, Train Loss: 0.4167, Test Acc: 0.7260, Test Loss: 0.5552
Confusion Matrix:
[[26 15]
 [ 2 30]]
Epoch: 012, Train Acc: 0.8947, Train Loss: 0.3973, Test Acc: 0.7671, Test Loss: 0.5425
Confusion Matrix:
[[26 15]
 [ 2 30]]
Epoch: 013, Train Acc: 0.8947, Train Loss: 0.3801, Test Acc: 0.7671, Test Loss: 0.5370
Confusion Matrix:
[[24 17]
 [ 2 30]]
Epoch: 014, Train Acc: 0.8947, Train Loss: 0.3646, Test Acc: 0.7397, Test Loss: 0.5389
Confusion Matrix:
[[23 18]
 [ 2 30]]
Epoch: 015, Train Acc: 0.8947, Train Loss: 0.3507, Test Acc: 0.7260, Test Loss: 0.5462
Confusion Matrix:
[[23 18]
 [ 2 30]]
Epoch: 016, Train Acc: 0.8947, Train Loss: 0.3366, Test Acc: 0.7260, Test Loss: 0.5530
Confusion Matrix:
[[23 18]
 [ 2 30]]
Epoch: 017, Train Acc: 0.8947, Train Loss: 0.3289, Test Acc: 0.7260, Test Loss: 0.5535
Confusion Matrix:
[[26 15]
 [ 2 30]]
Epoch: 018, Train Acc: 0.8947, Train Loss: 0.3240, Test Acc: 0.7671, Test Loss: 0.5447
Confusion Matrix:
[[27 14]
 [ 3 29]]
Epoch: 019, Train Acc: 0.8947, Train Loss: 0.3182, Test Acc: 0.7671, Test Loss: 0.5313
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 020, Train Acc: 0.8947, Train Loss: 0.3187, Test Acc: 0.7534, Test Loss: 0.5192
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 021, Train Acc: 0.8947, Train Loss: 0.3174, Test Acc: 0.7534, Test Loss: 0.5144
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 022, Train Acc: 0.8947, Train Loss: 0.3177, Test Acc: 0.7534, Test Loss: 0.5187
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 023, Train Acc: 0.9123, Train Loss: 0.3174, Test Acc: 0.7534, Test Loss: 0.5307
Confusion Matrix:
[[27 14]
 [ 3 29]]
Epoch: 024, Train Acc: 0.8947, Train Loss: 0.3159, Test Acc: 0.7671, Test Loss: 0.5452
Confusion Matrix:
[[27 14]
 [ 3 29]]
Epoch: 025, Train Acc: 0.8947, Train Loss: 0.3231, Test Acc: 0.7671, Test Loss: 0.5546
Confusion Matrix:
[[27 14]
 [ 3 29]]
Epoch: 026, Train Acc: 0.8947, Train Loss: 0.3208, Test Acc: 0.7671, Test Loss: 0.5560
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 027, Train Acc: 0.8947, Train Loss: 0.3254, Test Acc: 0.7534, Test Loss: 0.5494
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 028, Train Acc: 0.8947, Train Loss: 0.3207, Test Acc: 0.7534, Test Loss: 0.5414
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 029, Train Acc: 0.9123, Train Loss: 0.3260, Test Acc: 0.7534, Test Loss: 0.5348
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 030, Train Acc: 0.8947, Train Loss: 0.3266, Test Acc: 0.7534, Test Loss: 0.5345
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 031, Train Acc: 0.9123, Train Loss: 0.3227, Test Acc: 0.7534, Test Loss: 0.5345
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 032, Train Acc: 0.9123, Train Loss: 0.3206, Test Acc: 0.7534, Test Loss: 0.5350
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 033, Train Acc: 0.9123, Train Loss: 0.3224, Test Acc: 0.7534, Test Loss: 0.5357
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 034, Train Acc: 0.8947, Train Loss: 0.3226, Test Acc: 0.7534, Test Loss: 0.5366
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 035, Train Acc: 0.8947, Train Loss: 0.3233, Test Acc: 0.7534, Test Loss: 0.5375
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 036, Train Acc: 0.8947, Train Loss: 0.3221, Test Acc: 0.7534, Test Loss: 0.5386
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 037, Train Acc: 0.9123, Train Loss: 0.3202, Test Acc: 0.7534, Test Loss: 0.5396
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 038, Train Acc: 0.8947, Train Loss: 0.3216, Test Acc: 0.7534, Test Loss: 0.5405
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 039, Train Acc: 0.8947, Train Loss: 0.3221, Test Acc: 0.7534, Test Loss: 0.5413
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 040, Train Acc: 0.8947, Train Loss: 0.3232, Test Acc: 0.7534, Test Loss: 0.5418
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 041, Train Acc: 0.8947, Train Loss: 0.3195, Test Acc: 0.7534, Test Loss: 0.5421
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 042, Train Acc: 0.8947, Train Loss: 0.3170, Test Acc: 0.7534, Test Loss: 0.5422
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 043, Train Acc: 0.8947, Train Loss: 0.3212, Test Acc: 0.7534, Test Loss: 0.5421
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 044, Train Acc: 0.8947, Train Loss: 0.3221, Test Acc: 0.7534, Test Loss: 0.5418
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 045, Train Acc: 0.8947, Train Loss: 0.3198, Test Acc: 0.7534, Test Loss: 0.5412
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 046, Train Acc: 0.8947, Train Loss: 0.3229, Test Acc: 0.7534, Test Loss: 0.5406
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 047, Train Acc: 0.8947, Train Loss: 0.3169, Test Acc: 0.7534, Test Loss: 0.5398
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 048, Train Acc: 0.8947, Train Loss: 0.3180, Test Acc: 0.7534, Test Loss: 0.5390
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 049, Train Acc: 0.8947, Train Loss: 0.3170, Test Acc: 0.7534, Test Loss: 0.5383
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 050, Train Acc: 0.8947, Train Loss: 0.3182, Test Acc: 0.7534, Test Loss: 0.5374
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 051, Train Acc: 0.8947, Train Loss: 0.3183, Test Acc: 0.7534, Test Loss: 0.5365
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 052, Train Acc: 0.8947, Train Loss: 0.3199, Test Acc: 0.7534, Test Loss: 0.5356
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 053, Train Acc: 0.8947, Train Loss: 0.3189, Test Acc: 0.7534, Test Loss: 0.5349
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 054, Train Acc: 0.8947, Train Loss: 0.3155, Test Acc: 0.7534, Test Loss: 0.5343
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 055, Train Acc: 0.8947, Train Loss: 0.3167, Test Acc: 0.7534, Test Loss: 0.5338
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 056, Train Acc: 0.8947, Train Loss: 0.3190, Test Acc: 0.7534, Test Loss: 0.5334
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 057, Train Acc: 0.8947, Train Loss: 0.3141, Test Acc: 0.7534, Test Loss: 0.5331
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 058, Train Acc: 0.8947, Train Loss: 0.3165, Test Acc: 0.7534, Test Loss: 0.5328
Confusion Matrix:
[[27 14]
 [ 4 28]]
Epoch: 059, Train Acc: 0.8947, Train Loss: 0.3177, Test Acc: 0.7534, Test Loss: 0.5326
Traceback (most recent call last):
  File "run_GNN.py", line 98, in <module>
    main(args)
  File "run_GNN.py", line 94, in main
    run_vpu(config, loaders, NetworkPhi)
  File "/bigdata/projects/beidi/git/vpu-slide/vpu_GNN.py", line 147, in run_vpu
    print('Early stopping at {:}th epoch, test AUC : {:.4f}, test acc: {:.4f}'.format(epoch_of_best_val,
UnboundLocalError: local variable 'epoch_of_best_val' referenced before assignment
